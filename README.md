# PHP Form Submission System with Authentication

This project implements a simple, pure PHP web application following the **Model-View-Controller (MVC)** architectural pattern, **Object-Oriented Programming (OOP)**, and utilizing **PSR-4 autoloading** via Composer. It includes a user authentication system and a validated data submission system.

## Prerequisites

* A web server (e.g., Apache with `mod_rewrite` enabled or Nginx).
* PHP (7.4+ recommended).
* MySQL database.
* Composer for dependency management and autoloading.

---

## ðŸš€ Setup Instructions

### 1. Database Setup

1.  Create a MySQL database named `roxnor_db`.
2.  Execute the provided SQL schema:

    ```sql
    CREATE DATABASE IF NOT EXISTS roxnor_db;
    USE roxnor_db;

    -- User Table (for Authentication)
    CREATE TABLE IF NOT EXISTS users (
        id BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
        name VARCHAR(255) NOT NULL,
        email VARCHAR(50) NOT NULL UNIQUE,
        password VARCHAR(255) NOT NULL
    );

    -- Submission Table (for Data Submission)
    CREATE TABLE IF NOT EXISTS submissions (
        id BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
        amount INT(10) NOT NULL,
        buyer VARCHAR(255) NOT NULL,
        receipt_id VARCHAR(20) NOT NULL,
        items VARCHAR(255) NOT NULL,
        buyer_email VARCHAR(50) NOT NULL,
        buyer_ip VARCHAR(20) NOT NULL,
        note TEXT,
        city VARCHAR(20) NOT NULL,
        phone VARCHAR(20) NOT NULL,
        hash_key VARCHAR(255) NOT NULL,
        entry_at DATE NOT NULL,
        entry_by INT(10) NOT NULL,
        FOREIGN KEY (entry_by) REFERENCES users(id) 
    );
    ```

### 2. Configuration

1.  Update the database connection details in `app/Core/Database.php`:
    ```php
    private $host = 'localhost';
    private $user = 'root'; // <- CHANGE THIS
    private $pass = 'root_password'; // <- CHANGE THIS
    private $dbName = 'roxnor_db';
    ```
2.  Update the unique salt in `app/Controllers/SubmissionController.php`:
    ```php
    private $salt = 'your_long_secure_salt_string_here'; // <- CHANGE THIS TO A REAL, UNIQUE, LONG STRING
    ```

### 3. Install Dependencies

Navigate to the project root directory and run Composer:

```bash
composer install
```

This will create the vendor/autoload.php file required for PSR-4 autoloading.

### 4. Web Server Setup

* **Document Root:** The web server's document root must be set to the `public/` directory.
* **Rewrite Module:** Ensure `mod_rewrite` is enabled for Apache to allow clean URLs via the `public/.htaccess` file.

## ðŸ—ï¸ Key Features & Architecture

This application is built on a robust, pure PHP foundation, designed for clarity, security, and maintainability

### ðŸ—ï¸ Core Architecture & Structure

* **Pure PHP MVC:** The system strictly adheres to the **Model-View-Controller (MVC)** pattern, ensuring clean separation of concerns:
    * **Models:** Handle all database interactions (`mysqli`) and business logic.
    * **Views:** Contain HTML and presentation logic.
    * **Controllers:** Manage incoming requests, process data, and coordinate interactions between Models and Views.
* **Autoloading:** Uses Composer and **PSR-4** standard autoloading to automatically load all classes under the `App\` namespace, eliminating manual file inclusion and improving code organization.

### ðŸ›¡ï¸ Security and Authentication
* **Secure Password Storage:** User passwords are not stored in plain text; they are hashed using PHP's modern and secure built-in `password_hash()` function (`Bcrypt` algorithm by default).
* **Session Management:** User state is managed securely using PHP sessions, storing minimal identifying information (like `user_id`) to maintain login status.
* **Input Validation:**
    * **Frontend Validation (JavaScript):** Provides immediate user feedback on field constraints and formats (e.g., email structure).
    * **Backend Validation (PHP):** Critical server-side checks are performed on all submitted data before any database query is executed, mitigating risks like SQL injection and data corruption.

### ðŸ“Š Data Submission & Integrity
* **Automated Data Capture:** The system automatically captures and records several key pieces of information upon submission:
    * `buyer_ip`: Records the IP address of the user making the submission. (Note: This will show `::1` or `127.0.0.1` in a local development environment).
    * `entry_at`: Stores the local date the data was entered.
* **Uniqueness & Integrity (Hash Key):** A **SHA-512** `hash_key` is automatically calculated for every submission. This hash key is generated by combining critical fields (e.g., `amount`, `receipt_id`, `buyer_email`, and the unique secret `$salt`). This ensures data integrity and provides a non-reversible unique identifier for each submission record.
* **Rate Limiting:** A **24-hour cookie-based block** is implemented in the `SubmissionController` to prevent a single user from making rapid, multiple submissions, thereby reducing potential abuse or accidental duplicate entries.

### ðŸ” Reporting and Filtering
* **Dynamic Reports::** The `ReportController` displays all recorded submissions in a clear tabular format.
* **Filtering Capability:** Allows users (or administrators, depending on the model implementation) to filter the results dynamically based on a **date range** (`start_date`, `end_date`) and a specific **User ID** (`entry_by`).
